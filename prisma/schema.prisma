generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                       String                 @id @default(cuid())
  email                    String                 @unique
  name                     String?
  password                 String?
  createdAt                DateTime               @default(now())
  updatedAt                DateTime               @updatedAt
  image                    String?
  currentLevel             Int                    @default(1)
  maxUnlockedLevel         Int                    @default(1)
  subscriptionTier         String                 @default("free")
  totalChallengesCompleted Int                    @default(0)
  firebaseUid              String?                 @unique
  emailVerifiedAt          DateTime?
  emailVerified            Boolean                @default(false)
  isAdmin                  Boolean?               @default(false)
  role                     String?                @default("USER")
  isEarlyAdopter           Boolean?               @default(false)
  earlyAdopterTier         EarlyAdopterTier?
  earlyAdopterStartDate    DateTime?
  earlyAdopterEndDate      DateTime?
  discountCodeUsed         String?
  referralCode             String?  @unique
  referredByUserId         String?
  referralCount            Int?                   @default(0)
  totalReferralCredits     Int?                   @default(0)
  aiCredit                 AICredit?
  aigpExamAttempts         AIGPExamAttempt[]
  aigpFlashcardProgress    AIGPFlashcardProgress[]
  accounts                 Account[]
  agentConversations       AgentConversation[]
  challengeAttempts        ChallengeAttempt[]
  creditTransactions       CreditTransaction[]
  discountCodeUsages       DiscountCodeUsage[]
  examAttempts             ExamAttempt[]
  feedback                 Feedback[]
  payments                 Payment[]
  referralReceived         Referral?              @relation("Referee")
  referralsGiven           Referral[]             @relation("Referrer")
  sessions                 Session[]
  subscription             Subscription?
  badges                   UserBadge[]
  categoryProgress         UserCategoryProgress[]
  levelProgress            UserLevelProgress[]
  points                   UserPoints?
  profile                  UserProfile?
  progress                 UserProgress[]
  streaks                  UserStreak?
}

model Account {
  id                String  @id @default(cuid())
  userId            String
  type              String
  provider          String
  providerAccountId String
  refresh_token     String?
  access_token      String?
  expires_at        Int?
  token_type        String?
  scope             String?
  id_token          String?
  session_state     String?
  user              User    @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([provider, providerAccountId])
  @@index([userId])
}

model Session {
  id           String   @id @default(cuid())
  sessionToken String   @unique
  userId       String
  expires      DateTime
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
}

model VerificationToken {
  identifier String
  token      String   @unique
  expires    DateTime

  @@unique([identifier, token])
}

model Domain {
  id          String     @id @default(cuid())
  name        String     @unique
  order       Int        @unique
  description String?
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
  categories  Category[]
}

model Category {
  id               String                  @id @default(cuid())
  domainId         String
  name             String
  order            Int
  description      String?
  examSystemPrompt String                  @default("Generate exam questions for this category.")
  createdAt        DateTime                @default(now())
  updatedAt        DateTime                @updatedAt
  domain           Domain                  @relation(fields: [domainId], references: [id], onDelete: Cascade)
  concepts         ConceptCard[]
  exams            Exam[]
  levelCoverage    LevelCategoryCoverage[]
  userProgress     UserCategoryProgress[]

  @@unique([domainId, name])
  @@unique([domainId, order])
  @@index([domainId])
}

model ConceptCard {
  id                   String         @id @default(cuid())
  domain               String
  category             String
  concept              String
  definition           String
  examples             String?
  scenarioQuestion     String?
  optionA              String?
  optionB              String?
  optionC              String?
  optionD              String?
  correctAnswer        String?
  rationale            String?
  difficulty           String
  estimatedReadTime    Int            @default(0)
  domainClassification String?
  overview             String?
  governanceContext    String?
  ethicalImplications  String?
  keyTakeaways         String?
  version              String?        @default("1.0.0")
  createdAt            DateTime       @default(now())
  updatedAt            DateTime       @updatedAt
  importance           String         @default("medium")
  lastUpdated          DateTime       @default(now())
  source               String?
  sourceUrl            String?
  updatedBy            String?
  boundary             String?
  categoryId           String?
  name                 String?        @unique
  shortDefinition      String?
  categoryRelation     Category?      @relation(fields: [categoryId], references: [id], onDelete: Restrict)
  progress             UserProgress[]
}

model UserProgress {
  id            String      @id @default(cuid())
  userId        String
  conceptCardId String
  status        String      @default("not_started")
  completedAt   DateTime?
  timeSpent     Int         @default(0)
  masteryScore  Float?      @default(0)
  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt
  conceptCard   ConceptCard @relation(fields: [conceptCardId], references: [id], onDelete: Cascade)
  user          User        @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, conceptCardId])
  @@index([userId])
  @@index([conceptCardId])
}

model UserPoints {
  id                String   @id @default(cuid())
  userId            String   @unique
  totalPoints       Int      @default(0)
  pointsEarnedToday Int      @default(0)
  lastPointsReset   DateTime @default(now())
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
  user              User     @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model Badge {
  id          String      @id @default(cuid())
  name        String      @unique
  description String
  iconUrl     String?
  badgeType   String
  rarity      String      @default("common")
  createdAt   DateTime    @default(now())
  userBadges  UserBadge[]
}

model UserBadge {
  id       String   @id @default(cuid())
  userId   String
  badgeId  String
  earnedAt DateTime @default(now())
  badge    Badge    @relation(fields: [badgeId], references: [id], onDelete: Cascade)
  user     User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, badgeId])
  @@index([userId])
}

model UserStreak {
  id               String   @id @default(cuid())
  userId           String   @unique
  currentStreak    Int      @default(0)
  longestStreak    Int      @default(0)
  lastActivityDate DateTime @default(now())
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt
  user             User     @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model Challenge {
  id               String                  @id @default(cuid())
  level            Int
  title            String
  description      String?
  questionCount    Int                     @default(10)
  timeLimit        Int                     @default(20)
  passingScore     Int                     @default(70)
  concepts         String[]
  isActive         Boolean                 @default(true)
  createdAt        DateTime                @default(now())
  updatedAt        DateTime                @updatedAt
  examSystemPrompt String                  @default("Generate exam questions for this level.")
  isBoss           Boolean                 @default(false)
  levelNumber      Int?                    @unique
  superLevelGroup  SuperLevelGroup?
  attempts         ChallengeAttempt[]
  questions        ChallengeQuestion[]
  exams            Exam[]
  categoryCoverage LevelCategoryCoverage[]
  userProgress     UserLevelProgress[]

  @@index([levelNumber])
  @@index([superLevelGroup])
}

model ChallengeAttempt {
  id             String            @id @default(cuid())
  userId         String
  challengeId    String
  score          Float
  percentage     Float
  timeSpent      Int
  passed         Boolean
  isFirstAttempt Boolean           @default(true)
  completedAt    DateTime          @default(now())
  createdAt      DateTime          @default(now())
  answers        ChallengeAnswer[]
  challenge      Challenge         @relation(fields: [challengeId], references: [id], onDelete: Cascade)
  user           User              @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([challengeId])
  @@index([completedAt])
}

model ChallengeQuestion {
  id            String            @id @default(cuid())
  challengeId   String
  questionText  String
  questionType  String            @default("multiple_choice")
  options       Json
  correctAnswer String
  rationale     String
  conceptIds    String[]
  difficulty    String
  aiGenerated   Boolean           @default(false)
  order         Int
  createdAt     DateTime          @default(now())
  answers       ChallengeAnswer[]
  challenge     Challenge         @relation(fields: [challengeId], references: [id], onDelete: Cascade)

  @@index([challengeId])
  @@index([order])
}

model ChallengeAnswer {
  id             String            @id @default(cuid())
  attemptId      String
  questionId     String
  selectedAnswer String
  isCorrect      Boolean
  timeSpent      Int
  createdAt      DateTime          @default(now())
  attempt        ChallengeAttempt  @relation(fields: [attemptId], references: [id], onDelete: Cascade)
  question       ChallengeQuestion @relation(fields: [questionId], references: [id], onDelete: Cascade)

  @@index([attemptId])
  @@index([questionId])
}

model LevelCategoryCoverage {
  id           String       @id @default(cuid())
  levelNumber  Int
  categoryId   String
  coverageType CoverageType
  weight       Float?       @default(1.0)
  category     Category     @relation(fields: [categoryId], references: [id], onDelete: Cascade)
  challenge    Challenge    @relation(fields: [levelNumber], references: [levelNumber], onDelete: Cascade)

  @@unique([levelNumber, categoryId, coverageType])
  @@index([levelNumber])
  @@index([categoryId])
}

model Exam {
  id                   String        @id @default(cuid())
  type                 ExamType
  status               ExamStatus    @default(DRAFT)
  version              Int           @default(1)
  categoryId           String?
  levelNumber          Int?
  systemPromptSnapshot String
  generationConfig     Json
  questions            Json
  createdAt            DateTime      @default(now())
  updatedAt            DateTime      @updatedAt
  category             Category?     @relation(fields: [categoryId], references: [id], onDelete: Cascade)
  challenge            Challenge?    @relation(fields: [levelNumber], references: [levelNumber], onDelete: Cascade)
  attempts             ExamAttempt[]

  @@index([type, status])
  @@index([categoryId])
  @@index([levelNumber])
}

model ExamAttempt {
  id             String        @id @default(cuid())
  examId         String
  userId         String
  attemptNumber  Int           @default(1)
  startedAt      DateTime      @default(now())
  submittedAt    DateTime?
  score          Float?
  pass           Boolean?
  answers        Json
  feedback       Json?
  evaluatedAt    DateTime?
  nextEligibleAt DateTime?
  status         AttemptStatus @default(IN_PROGRESS)
  exam           Exam          @relation(fields: [examId], references: [id], onDelete: Cascade)
  user           User          @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([examId, userId, attemptNumber])
  @@index([userId])
  @@index([examId])
  @@index([status])
}

model AIGPExam {
  id                       String            @id @default(cuid())
  examId                   String            @unique
  title                    String
  version                  String
  description              String?
  totalQuestions           Int               @default(100)
  estimatedTimeMin         Int
  passMark                 Float?
  domainDistribution       Json
  difficultyDistribution   Json
  jurisdictionDistribution Json
  status                   ExamStatus        @default(PUBLISHED)
  isActive                 Boolean           @default(true)
  createdAt                DateTime          @default(now())
  updatedAt                DateTime          @default(now()) @updatedAt
  attempts                 AIGPExamAttempt[]
  questions                AIGPQuestion[]

  @@index([status, isActive])
  @@index([examId])
}

model AIGPQuestion {
  id               String           @id @default(cuid())
  examId           String
  questionId       String           @unique
  question         String
  options          Json
  correctAnswer    String
  explanation      String
  domain           String
  topic            String
  difficulty       String
  isCaseStudy      Boolean          @default(false)
  estimatedTimeSec Int
  jurisdiction     String
  sourceRefs       String[]
  questionOrder    Int
  createdAt        DateTime         @default(now())
  updatedAt        DateTime         @default(now()) @updatedAt
  attemptAnswers   AIGPExamAnswer[]
  exam             AIGPExam         @relation(fields: [examId], references: [id], onDelete: Cascade)

  @@unique([examId, questionOrder])
  @@index([examId])
  @@index([domain])
  @@index([difficulty])
  @@index([jurisdiction])
  @@index([topic])
  @@index([questionId])
}

model AIGPExamAttempt {
  id                 String           @id @default(cuid())
  examId             String
  userId             String
  attemptNumber      Int              @default(1)
  status             AttemptStatus    @default(IN_PROGRESS)
  startedAt          DateTime         @default(now())
  pausedAt           DateTime?
  resumedAt          DateTime?
  submittedAt        DateTime?
  evaluatedAt        DateTime?
  isTimed            Boolean          @default(true)
  timeLimitSec       Int?
  timeRemainingSec   Int?
  score              Float?
  rawScore           Int?
  totalQuestions     Int?
  pass               Boolean?
  domainScores       Json?
  difficultyScores   Json?
  jurisdictionScores Json?
  topicScores        Json?
  flaggedQuestions   String[]
  createdAt          DateTime         @default(now())
  updatedAt          DateTime         @default(now())
  answers            AIGPExamAnswer[]
  exam               AIGPExam         @relation(fields: [examId], references: [id], onDelete: Cascade)
  user               User             @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([examId, userId, attemptNumber])
  @@index([userId])
  @@index([examId])
  @@index([status])
  @@index([submittedAt])
  @@index([createdAt])
}

model AIGPExamAnswer {
  id             String          @id @default(cuid())
  attemptId      String
  questionId     String
  selectedAnswer String?
  isCorrect      Boolean?
  timeSpentSec   Int?
  optionOrder    Json?
  shuffledOrder  Json?
  isFlagged      Boolean         @default(false)
  createdAt      DateTime        @default(now())
  updatedAt      DateTime        @default(now())
  attempt        AIGPExamAttempt @relation(fields: [attemptId], references: [id], onDelete: Cascade)
  question       AIGPQuestion    @relation(fields: [questionId], references: [id], onDelete: Cascade)

  @@unique([attemptId, questionId])
  @@index([attemptId])
  @@index([questionId])
  @@index([isCorrect])
}

model AIGPFlashcard {
  id            String                  @id @default(cuid())
  flashcardId   String                  @unique // Original ID from JSON (e.g., "fc_a1_accountability_missing_owner_v1")
  status        String                  @default("ACTIVE") // ACTIVE, INACTIVE
  cardType      String                  // TRIGGER, DIFFERENTIATION, PROCESS, DEFINITION
  domain        String                  // A, B, C, D, E, F
  subDomain     String
  topics        String[]                // Array of topic strings
  priority      String                  // HIGH, MEDIUM, LOW
  frontPrompt   String                  @db.Text
  backAnswer    String                  @db.Text
  examCue       String                  @db.Text
  commonTrap    String                  @db.Text
  sourceFramework String?
  sourcePointer  String?
  batchId       String?                 // Which batch file it came from
  version       String?                 // Version from batch
  createdAt     DateTime                @default(now())
  updatedAt     DateTime                @updatedAt
  progress      AIGPFlashcardProgress[]

  @@index([domain])
  @@index([subDomain])
  @@index([cardType])
  @@index([priority])
  @@index([status])
}

model AIGPFlashcardProgress {
  id            String          @id @default(cuid())
  userId        String
  flashcardId   String          // References AIGPFlashcard.flashcardId (not id)
  status        FlashcardStatus @default(NOT_STARTED)
  timesViewed   Int             @default(0)
  timesCorrect  Int             @default(0)
  lastViewedAt  DateTime?
  masteredAt    DateTime?
  createdAt     DateTime        @default(now())
  updatedAt     DateTime        @updatedAt
  user          User            @relation(fields: [userId], references: [id], onDelete: Cascade)
  flashcard     AIGPFlashcard?  @relation(fields: [flashcardId], references: [flashcardId], onDelete: Cascade)

  @@unique([userId, flashcardId])
  @@index([userId])
  @@index([flashcardId])
  @@index([status])
}

enum FlashcardStatus {
  NOT_STARTED
  REVIEWING
  MASTERED
}

model UserCategoryProgress {
  id         String         @id @default(cuid())
  userId     String
  categoryId String
  status     ProgressStatus @default(LOCKED)
  bestScore  Float?
  passedAt   DateTime?
  category   Category       @relation(fields: [categoryId], references: [id], onDelete: Cascade)
  user       User           @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, categoryId])
  @@index([userId])
  @@index([categoryId])
}

model UserLevelProgress {
  id            String         @id @default(cuid())
  userId        String
  unlockedAt    DateTime       @default(now())
  bestScore     Float?
  attemptsCount Int            @default(0)
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
  levelNumber   Int
  passedAt      DateTime?
  status        ProgressStatus @default(LOCKED)
  challenge     Challenge      @relation(fields: [levelNumber], references: [levelNumber], onDelete: Cascade)
  user          User           @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, levelNumber])
  @@index([userId])
  @@index([levelNumber])
}

model Subscription {
  id                   String    @id @default(cuid())
  userId               String    @unique
  stripeCustomerId     String    @unique
  stripeSubscriptionId String?   @unique
  stripePriceId        String?
  status               String
  planType             String?
  currentPeriodStart   DateTime?
  currentPeriodEnd     DateTime?
  cancelAtPeriodEnd    Boolean   @default(false)
  createdAt            DateTime  @default(now())
  updatedAt            DateTime  @updatedAt
  user                 User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([stripeCustomerId])
  @@index([status])
}

model Payment {
  id              String   @id @default(cuid())
  userId          String
  stripePaymentId String   @unique
  amount          Int
  currency        String   @default("usd")
  status          String
  planType        String?
  refundedAmount  Int      @default(0)
  refundedAt      DateTime?
  refundReason    String?
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  user            User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([stripePaymentId])
  @@index([status])
}

model UserProfile {
  id               String                     @id @default(cuid())
  userId           String                     @unique
  personaType      String?
  customPersona    String?
  knowledgeLevel   String                     @default("NOT_ASSESSED")
  onboardingStatus String                     @default("NOT_STARTED")
  completedAt      DateTime?
  createdAt        DateTime                   @default(now())
  updatedAt        DateTime                   @updatedAt
  scenarioAnswers  OnboardingScenarioAnswer[]
  goals            UserGoal[]
  interests        UserInterest[]
  user             User                       @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([personaType])
  @@index([onboardingStatus])
}

model UserInterest {
  id          String      @id @default(cuid())
  userId      String
  interest    String
  userProfile UserProfile @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, interest])
  @@index([userId])
  @@index([interest])
}

model UserGoal {
  id          String      @id @default(cuid())
  userId      String
  goal        String
  userProfile UserProfile @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, goal])
  @@index([userId])
  @@index([goal])
}

model OnboardingScenario {
  id            String      @id @default(cuid())
  personaType   PersonaType
  questionOrder Int
  scenario      String
  question      String
  optionA       String
  optionB       String
  optionC       String
  optionD       String
  correctAnswer String
  explanation   String?
  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt

  @@unique([personaType, questionOrder])
  @@index([personaType])
  @@index([questionOrder])
}

model OnboardingScenarioAnswer {
  id             String      @id @default(cuid())
  userId         String
  scenarioId     String
  selectedAnswer String
  isCorrect      Boolean
  answeredAt     DateTime    @default(now())
  userProfile    UserProfile @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, scenarioId])
  @@index([userId])
  @@index([scenarioId])
}

model AgentConversation {
  id           String   @id @default(cuid())
  userId       String
  title        String?
  messages     Json     @default("[]")
  contextUsed  Json?
  sourcesCited Json?
  messageCount Int      @default(0)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @default(now()) @updatedAt
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([createdAt])
}

model AICredit {
  id                   String              @id @default(cuid())
  userId               String              @unique
  subscriptionId       String?
  monthlyAllowance     Int                 @default(1000)
  currentBalance       Int                 @default(1000)
  purchasedCredits     Int                 @default(0)
  billingCycleStart    DateTime            @default(now())
  billingCycleEnd      DateTime
  totalCreditsUsed     Int                 @default(0)
  creditsUsedThisCycle Int                 @default(0)
  createdAt            DateTime            @default(now())
  updatedAt            DateTime            @default(now()) @updatedAt
  user                 User                @relation(fields: [userId], references: [id], onDelete: Cascade)
  creditTransactions   CreditTransaction[]
}

model CreditTransaction {
  id              String                @id @default(cuid())
  creditId        String
  userId          String
  amount          Int
  type            CreditTransactionType
  description     String
  service         String?
  tokensUsed      Int?
  costPerToken    Float?
  inputTokens     Int?
  outputTokens    Int?
  balanceBefore   Int
  balanceAfter    Int
  stripePaymentId String?
  expiresAt       DateTime?
  createdAt       DateTime              @default(now())
  credit          AICredit              @relation(fields: [creditId], references: [id], onDelete: Cascade)
  user            User                  @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([creditId])
  @@index([userId])
  @@index([createdAt])
}

model DiscountCode {
  id                    String              @id @default(cuid())
  code                  String              @unique
  description           String?
  type                  DiscountCodeType    @default(PERCENTAGE)
  value                 Float
  status                DiscountCodeStatus  @default(ACTIVE)
  maxUses               Int?
  currentUses           Int                 @default(0)
  maxUsesPerUser        Int                 @default(1)
  applicableToPlanTypes String[]            @default([])
  minAmount             Int?
  validFrom             DateTime            @default(now())
  validUntil            DateTime?
  earlyAdopterTier      EarlyAdopterTier?
  createdBy             String?
  notes                 String?
  createdAt             DateTime            @default(now())
  updatedAt             DateTime            @default(now()) @updatedAt
  usages                DiscountCodeUsage[]

  @@index([code])
  @@index([status])
  @@index([earlyAdopterTier])
  @@index([validFrom])
  @@index([validUntil])
}

model DiscountCodeUsage {
  id             String       @id @default(cuid())
  discountCodeId String
  userId         String
  subscriptionId String?
  paymentId      String?
  amountSaved    Int
  createdAt      DateTime     @default(now())
  discountCode   DiscountCode @relation(fields: [discountCodeId], references: [id], onDelete: Cascade)
  user           User         @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([discountCodeId])
  @@index([userId])
  @@index([createdAt])
}

model Referral {
  id               String    @id @default(cuid())
  referrerId       String
  refereeId        String    @unique
  referralCode     String
  status           String    @default("pending")
  referrerRewarded Boolean   @default(false)
  refereeRewarded  Boolean   @default(false)
  rewardCredits    Int       @default(0)
  createdAt        DateTime  @default(now())
  completedAt      DateTime?
  referee          User      @relation("Referee", fields: [refereeId], references: [id], onDelete: Cascade)
  referrer         User      @relation("Referrer", fields: [referrerId], references: [id], onDelete: Cascade)

  @@index([referrerId])
  @@index([refereeId])
  @@index([referralCode])
  @@index([status])
  @@index([createdAt])
}

model Feedback {
  id         String         @id @default(cuid())
  userId     String
  type       FeedbackType
  status     FeedbackStatus @default(PENDING)
  title      String?
  message    String
  pageUrl    String?
  metadata   Json?
  assignedTo String?
  priority   String?
  adminNotes String?
  resolvedAt DateTime?
  createdAt  DateTime       @default(now())
  updatedAt  DateTime       @default(now()) @updatedAt
  user       User           @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([type])
  @@index([status])
  @@index([createdAt])
  @@index([priority])
}

model UserEvent {
  id        String   @id @default(cuid())
  userId    String
  eventType String
  eventData Json?
  pageUrl   String?
  userAgent String?
  ipAddress String?
  createdAt DateTime @default(now())

  @@index([userId])
  @@index([eventType])
  @@index([createdAt])
}

enum SuperLevelGroup {
  FOUNDATION
  BUILDING
  ADVANCED
  MASTERY
}

enum ExamType {
  CATEGORY
  LEVEL
}

enum ExamStatus {
  DRAFT
  PUBLISHED
  RETIRED
}

enum ProgressStatus {
  LOCKED
  AVAILABLE
  PASSED
}

enum AttemptStatus {
  IN_PROGRESS
  SUBMITTED
  EVALUATED
  EXPIRED
}

enum CoverageType {
  INTRODUCED
  PRACTICED
  ASSESSED
}

enum PersonaType {
  COMPLIANCE_OFFICER
  AI_ETHICS_RESEARCHER
  TECHNICAL_AI_DEVELOPER
  LEGAL_REGULATORY_PROFESSIONAL
  BUSINESS_EXECUTIVE
  DATA_PROTECTION_OFFICER
  AI_GOVERNANCE_CONSULTANT
  AI_PRODUCT_MANAGER
  STUDENT_ACADEMIC
  OTHER
}

enum KnowledgeLevel {
  BEGINNER
  INTERMEDIATE
  ADVANCED
  NOT_ASSESSED
}

enum OnboardingStatus {
  NOT_STARTED
  PERSONA_SELECTED
  KNOWLEDGE_ASSESSED
  INTERESTS_SELECTED
  GOALS_SELECTED
  COMPLETED
  SKIPPED
}

enum SourceType {
  REGULATORY
  NEWS
  CASE_STUDY
  STANDARD
  LEGAL_DECISION
  ACADEMIC
  INDUSTRY_REPORT
  BLOG
}

enum ScanType {
  DAILY_REGULATORY
  DAILY_NEWS
  WEEKLY_CASE_STUDIES
  WEEKLY_FRAMEWORKS
  MONTHLY_COMPREHENSIVE
  ON_DEMAND
  BREAKING_NEWS
}

enum ScanStatus {
  PENDING
  RUNNING
  COMPLETED
  FAILED
  CANCELLED
}

enum CreditTransactionType {
  ALLOCATION
  USAGE
  RESET
  PURCHASE
  BONUS
  REFUND
}

enum DiscountCodeType {
  PERCENTAGE
  FIXED_AMOUNT
  FREE_TRIAL
}

enum DiscountCodeStatus {
  ACTIVE
  INACTIVE
  EXPIRED
  USED_UP
}

enum EarlyAdopterTier {
  FOUNDING_MEMBER
  EARLY_ADOPTER
  LAUNCH_USER
}

enum UserRole {
  USER
  ADMIN
  SUPER_ADMIN
}

enum FeedbackType {
  BUG
  FEATURE_REQUEST
  UX_ISSUE
  CONTENT_FEEDBACK
  GENERAL
}

enum FeedbackStatus {
  PENDING
  REVIEWED
  IN_PROGRESS
  RESOLVED
  REJECTED
}
